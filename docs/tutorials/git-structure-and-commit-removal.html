<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/git-structure-and-commit-removal" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn | Lê Việt Hưng</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://viethungle0503.github.io/viethungle/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://viethungle0503.github.io/viethungle/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://viethungle0503.github.io/viethungle/docs/tutorials/git-structure-and-commit-removal"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn | Lê Việt Hưng"><meta data-rh="true" name="description" content="Bài viết này giải thích cấu trúc thư mục .git và hướng dẫn cách loại bỏ các commit không mong muốn (như thêm node_modules) khỏi lịch sử Git mà không làm thay đổi thông tin author và thời gian commit."><meta data-rh="true" property="og:description" content="Bài viết này giải thích cấu trúc thư mục .git và hướng dẫn cách loại bỏ các commit không mong muốn (như thêm node_modules) khỏi lịch sử Git mà không làm thay đổi thông tin author và thời gian commit."><link data-rh="true" rel="icon" href="/viethungle/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://viethungle0503.github.io/viethungle/docs/tutorials/git-structure-and-commit-removal"><link data-rh="true" rel="alternate" href="https://viethungle0503.github.io/viethungle/docs/tutorials/git-structure-and-commit-removal" hreflang="en"><link data-rh="true" rel="alternate" href="https://viethungle0503.github.io/viethungle/docs/tutorials/git-structure-and-commit-removal" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn","item":"https://viethungle0503.github.io/viethungle/docs/tutorials/git-structure-and-commit-removal"}]}</script><link rel="alternate" type="application/rss+xml" href="/viethungle/blog/rss.xml" title="Lê Việt Hưng RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/viethungle/blog/atom.xml" title="Lê Việt Hưng Atom Feed"><link rel="stylesheet" href="/viethungle/assets/css/styles.2eab34b2.css">
<script src="/viethungle/assets/js/runtime~main.5a0a5436.js" defer="defer"></script>
<script src="/viethungle/assets/js/main.43ec6d95.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/viethungle/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/viethungle/"><div class="navbar__logo"><img src="/viethungle/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/viethungle/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/viethungle/docs/git-tips">Tutorial</a><a class="navbar__item navbar__link" href="/viethungle/docs/gaming/ark-cheats">Gaming</a><a class="navbar__item navbar__link" href="/viethungle/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/viethungle/docs/git-tips">Git Tips and Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/viethungle/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/viethungle/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/viethungle/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/viethungle/docs/category/aws---console">AWS - Console</a><button aria-label="Expand sidebar category &#x27;AWS - Console&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/viethungle/docs/gaming/ark-cheats">gaming</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/viethungle/docs/tutorials/sparse-checkout">tutorials</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/sparse-checkout">Sparse Checkout in Git</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/cleanup-git-branches">Cleaning Up Git Branches</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/nginx-proxy-manager-symlink-fix">Khắc Phục Symlink Nginx Proxy Manager Sau Backup Thủ Công</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/nginx-proxy-manager-symlink-fix-en">Fixing Nginx Proxy Manager Symlinks After Manual Backup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/thunderbird-sent-thread-integration">Thunderbird - Hiển Thị Email Sent Trong Cùng Thread</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/windows-gpg-git-setup">Thiết Lập GPG Signing Cho Git Trên Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/gpu-benchmarks">Các trang web chuyên so sánh hiệu năng GPU</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/webrtc-p2p-sfu-opensource-projects">Các dự án mã nguồn mở cho P2P và SFU WebRTC Streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/network-monitoring-mtr-iperf3-tailscale">MTR, iperf3 và Tailscale - Công cụ đo mạng chuyên nghiệp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/streaming-servers-comparison-srs-mediamtx-zlmediakit">So sánh các Streaming Server: SRS vs MediaMTX vs ZLMediaKit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/recover-docker-run-command">Cách xem lại lệnh docker run từ container đang chạy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/open-source-databases-comparison">Các Database Open-Source Phổ Biến: So sánh tính năng và use case</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/gpg4win-backup-restore-private-key">Backup và Restore Private Key GPG trên Windows với GPG4win</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/viethungle/docs/tutorials/git-structure-and-commit-removal">Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/python_version_management">Quản lý phiên bản Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/java_version_management">Quản lý phiên bản Java và JVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/viethungle/docs/tutorials/supabase_cloudflare_tunnel_guide">Cấu hình Cloudflare Tunnel cho Supabase Self-hosted</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/viethungle/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">tutorials</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cấu trúc thư mục Git và cách loại bỏ commit không mong muốn</h1></header>
<p>Bài viết này giải thích cấu trúc thư mục <code>.git</code> và hướng dẫn cách loại bỏ các commit không mong muốn (như thêm <code>node_modules</code>) khỏi lịch sử Git mà không làm thay đổi thông tin author và thời gian commit.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-cấu-trúc-thư-mục-git">1. Cấu trúc thư mục .git<a href="#1-cấu-trúc-thư-mục-git" class="hash-link" aria-label="Direct link to 1. Cấu trúc thư mục .git" title="Direct link to 1. Cấu trúc thư mục .git">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-các-thư-mục-cốt-lõi">1.1 Các thư mục cốt lõi<a href="#11-các-thư-mục-cốt-lõi" class="hash-link" aria-label="Direct link to 1.1 Các thư mục cốt lõi" title="Direct link to 1.1 Các thư mục cốt lõi">​</a></h3>
<table><thead><tr><th>Thư mục/File</th><th>Chức năng</th></tr></thead><tbody><tr><td><code>objects/</code></td><td>Lưu trữ tất cả dữ liệu của Git (commits, trees, blobs) dưới dạng hash SHA-1</td></tr><tr><td><code>refs/</code></td><td>Chứa các tham chiếu (references) như branches, tags, remote branches</td></tr><tr><td><code>logs/</code></td><td>Lưu lịch sử thay đổi của các refs (reflog)</td></tr><tr><td><code>info/</code></td><td>Chứa thông tin bổ sung như exclude patterns</td></tr><tr><td><code>config</code></td><td>Cấu hình repository cụ thể</td></tr><tr><td><code>description</code></td><td>Mô tả repository (dùng cho GitWeb)</td></tr><tr><td><code>HEAD</code></td><td>Trỏ đến branch hiện tại</td></tr><tr><td><code>index</code></td><td>Staging area (những thay đổi chuẩn bị commit)</td></tr><tr><td><code>packed-refs</code></td><td>Các refs được pack để tối ưu hiệu suất</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-giải-thích-chi-tiết-objectspack">1.2 Giải thích chi tiết objects/pack<a href="#12-giải-thích-chi-tiết-objectspack" class="hash-link" aria-label="Direct link to 1.2 Giải thích chi tiết objects/pack" title="Direct link to 1.2 Giải thích chi tiết objects/pack">​</a></h3>
<p>Thư mục <code>objects/pack/</code> chứa:</p>
<ul>
<li><strong>File .pack</strong>: Chứa nhiều objects được nén lại để tiết kiệm không gian</li>
<li><strong>File .idx</strong>: Index của pack file, giúp Git tìm kiếm nhanh objects</li>
<li><strong>File .rev</strong>: Reverse index, tối ưu cho việc truy cập pack file</li>
</ul>
<p><strong>Tại sao file pack có dung lượng lớn?</strong></p>
<ul>
<li>Git tự động &quot;pack&quot; các objects để tiết kiệm không gian</li>
<li>Repository có lịch sử phát triển lâu dài với nhiều commits</li>
<li>Chứa binary files, images, hoặc assets lớn trong lịch sử</li>
<li>Delta compression lưu trữ sự khác biệt giữa các versions</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-liệt-kê-commit-theo-dung-lượng">2. Liệt kê commit theo dung lượng<a href="#2-liệt-kê-commit-theo-dung-lượng" class="hash-link" aria-label="Direct link to 2. Liệt kê commit theo dung lượng" title="Direct link to 2. Liệt kê commit theo dung lượng">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-lệnh-cơ-bản-liệt-kê-commit-theo-kích-thước">2.1 Lệnh cơ bản liệt kê commit theo kích thước<a href="#21-lệnh-cơ-bản-liệt-kê-commit-theo-kích-thước" class="hash-link" aria-label="Direct link to 2.1 Lệnh cơ bản liệt kê commit theo kích thước" title="Direct link to 2.1 Lệnh cơ bản liệt kê commit theo kích thước">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Liệt kê commit theo tổng số thay đổi (insertions + deletions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git log --oneline --shortstat | awk &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/^[a-f0-9]/{commit=$0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/files? changed/{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insertions=0; deletions=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if($0 ~ /[0-9]+ insertions?/) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match($0, /([0-9]+) insertions?/, arr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        insertions=arr[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if($0 ~ /[0-9]+ deletions?/) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match($0, /([0-9]+) deletions?/, arr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deletions=arr[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    total=insertions+deletions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print total &quot;\t&quot; commit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27; | sort -nr | head -20</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-tìm-các-file-lớn-nhất-trong-repository">2.2 Tìm các file lớn nhất trong repository<a href="#22-tìm-các-file-lớn-nhất-trong-repository" class="hash-link" aria-label="Direct link to 2.2 Tìm các file lớn nhất trong repository" title="Direct link to 2.2 Tìm các file lớn nhất trong repository">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git rev-list --objects --all | </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git cat-file --batch-check=&#x27;%(objecttype) %(objectname) %(objectsize) %(rest)&#x27; | </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">awk &#x27;/^blob/ {print substr($0,6)}&#x27; | </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort -k3 -n | </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tail -20</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-phân-tích-commit-chi-tiết">2.3 Phân tích commit chi tiết<a href="#23-phân-tích-commit-chi-tiết" class="hash-link" aria-label="Direct link to 2.3 Phân tích commit chi tiết" title="Direct link to 2.3 Phân tích commit chi tiết">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Commit Hash | Files Changed | Insertions | Deletions | Total Changes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;------------|---------------|------------|-----------|---------------&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git log --pretty=format:&#x27;%h&#x27; --shortstat | while read line; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [[ $line =~ ^[a-f0-9]{7}$ ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        commit_hash=$line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        read stats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if [[ -n $stats ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            files=$(echo $stats | grep -o &#x27;[0-9]\+ files\? changed&#x27; | grep -o &#x27;[0-9]\+&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            insertions=$(echo $stats | grep -o &#x27;[0-9]\+ insertions\?&#x27; | grep -o &#x27;[0-9]\+&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            deletions=$(echo $stats | grep -o &#x27;[0-9]\+ deletions\?&#x27; | grep -o &#x27;[0-9]\+&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            files=${files:-0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            insertions=${insertions:-0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            deletions=${deletions:-0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            total=$((insertions + deletions))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            printf &quot;%s | %s | %s | %s | %s\n&quot; &quot;$commit_hash&quot; &quot;$files&quot; &quot;$insertions&quot; &quot;$deletions&quot; &quot;$total&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done | sort -k5 -nr | head -20</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-loại-bỏ-commit-không-mong-muốn-với-git-filter-repo">3. Loại bỏ commit không mong muốn với git filter-repo<a href="#3-loại-bỏ-commit-không-mong-muốn-với-git-filter-repo" class="hash-link" aria-label="Direct link to 3. Loại bỏ commit không mong muốn với git filter-repo" title="Direct link to 3. Loại bỏ commit không mong muốn với git filter-repo">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-cài-đặt-git-filter-repo">3.1 Cài đặt <a href="https://github.com/newren/git-filter-repo" target="_blank" rel="noopener noreferrer">git-filter-repo</a><a href="#31-cài-đặt-git-filter-repo" class="hash-link" aria-label="Direct link to 31-cài-đặt-git-filter-repo" title="Direct link to 31-cài-đặt-git-filter-repo">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Cài đặt qua pip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install git-filter-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Hoặc trên macOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brew install git-filter-repo</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-loại-bỏ-thư-mục-khỏi-toàn-bộ-lịch-sử">3.2 Loại bỏ thư mục khỏi toàn bộ lịch sử<a href="#32-loại-bỏ-thư-mục-khỏi-toàn-bộ-lịch-sử" class="hash-link" aria-label="Direct link to 3.2 Loại bỏ thư mục khỏi toàn bộ lịch sử" title="Direct link to 3.2 Loại bỏ thư mục khỏi toàn bộ lịch sử">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Loại bỏ thư mục node_modules khỏi toàn bộ history</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git filter-repo --path node_modules --invert-paths --force</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Loại bỏ nhiều patterns cùng lúc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git filter-repo --path node_modules --path package-lock.json --invert-paths --force</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-xử-lý-lỗi-not-a-fresh-clone">3.3 Xử lý lỗi &quot;not a fresh clone&quot;<a href="#33-xử-lý-lỗi-not-a-fresh-clone" class="hash-link" aria-label="Direct link to 3.3 Xử lý lỗi &quot;not a fresh clone&quot;" title="Direct link to 3.3 Xử lý lỗi &quot;not a fresh clone&quot;">​</a></h3>
<p>Khi gặp lỗi:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Aborting: Refusing to destructively overwrite repo history since</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this does not look like a fresh clone.</span><br></span></code></pre></div></div>
<p><strong>Giải pháp 1: Sử dụng --force</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git filter-repo --path node_modules --invert-paths --force</span><br></span></code></pre></div></div>
<p><strong>Giải pháp 2: Tạo fresh clone</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Backup branch hiện tại</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git branch backup-original</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Tạo fresh clone từ local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --no-hardlinks /d/UELDaily UELDaily-clean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd UELDaily-clean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Chạy filter-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git filter-repo --path node_modules --invert-paths</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-phương-pháp-thay-thế">4. Phương pháp thay thế<a href="#4-phương-pháp-thay-thế" class="hash-link" aria-label="Direct link to 4. Phương pháp thay thế" title="Direct link to 4. Phương pháp thay thế">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-sử-dụng-bfg-repo-cleaner">4.1 Sử dụng BFG Repo-Cleaner<a href="#41-sử-dụng-bfg-repo-cleaner" class="hash-link" aria-label="Direct link to 4.1 Sử dụng BFG Repo-Cleaner" title="Direct link to 4.1 Sử dụng BFG Repo-Cleaner">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tải BFG từ https://rtyley.github.io/bfg-repo-cleaner/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Hoặc: brew install bfg (macOS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Clone bare repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --mirror https://github.com/user/repo.git repo.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd repo.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Xóa folder node_modules khỏi toàn bộ history</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java -jar bfg.jar --delete-folders node_modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Push changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reflog expire --expire=now --all &amp;&amp; git gc --prune=now --aggressive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push --force</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-git-filter-branch-phương-pháp-cũ">4.2 Git filter-branch (phương pháp cũ)<a href="#42-git-filter-branch-phương-pháp-cũ" class="hash-link" aria-label="Direct link to 4.2 Git filter-branch (phương pháp cũ)" title="Direct link to 4.2 Git filter-branch (phương pháp cũ)">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git filter-branch --force --index-filter \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;git rm -rf --cached --ignore-unmatch node_modules&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --prune-empty --tag-name-filter cat -- --all</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-dọn-dẹp-sau-khi-filter">5. Dọn dẹp sau khi filter<a href="#5-dọn-dẹp-sau-khi-filter" class="hash-link" aria-label="Direct link to 5. Dọn dẹp sau khi filter" title="Direct link to 5. Dọn dẹp sau khi filter">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-cleanup-commands">5.1 Cleanup commands<a href="#51-cleanup-commands" class="hash-link" aria-label="Direct link to 5.1 Cleanup commands" title="Direct link to 5.1 Cleanup commands">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Dọn dẹp reflog và garbage collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reflog expire --expire=now --all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git gc --prune=now --aggressive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Force push (CẨN THẬN!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push origin --force --all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push origin --force --tags</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-kiểm-tra-kết-quả">5.2 Kiểm tra kết quả<a href="#52-kiểm-tra-kết-quả" class="hash-link" aria-label="Direct link to 5.2 Kiểm tra kết quả" title="Direct link to 5.2 Kiểm tra kết quả">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Kiểm tra size repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">du -sh .git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Kiểm tra các file lớn còn lại</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git rev-list --objects --all | git cat-file --batch-check=&#x27;%(objecttype) %(objectname) %(objectsize) %(rest)&#x27; | awk &#x27;/^blob/ {print substr($0,6)}&#x27; | sort -k3 -n | tail -10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify node_modules đã bị xóa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git log --all --full-history -- node_modules</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-thông-tin-được-bảo-toàn">6. Thông tin được bảo toàn<a href="#6-thông-tin-được-bảo-toàn" class="hash-link" aria-label="Direct link to 6. Thông tin được bảo toàn" title="Direct link to 6. Thông tin được bảo toàn">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-dữ-liệu-không-thay-đổi">6.1 Dữ liệu không thay đổi<a href="#61-dữ-liệu-không-thay-đổi" class="hash-link" aria-label="Direct link to 6.1 Dữ liệu không thay đổi" title="Direct link to 6.1 Dữ liệu không thay đổi">​</a></h3>
<p>Khi sử dụng git filter-repo, các thông tin sau được giữ nguyên:</p>
<ul>
<li><strong>Author name &amp; email</strong> - Người tạo commit</li>
<li><strong>Author date</strong> - Thời gian commit được tạo</li>
<li><strong>Commit message</strong> - Nội dung commit</li>
<li><strong>Committer name &amp; email</strong> - Người apply commit</li>
<li><strong>Committer date</strong> - Thời gian commit được áp dụng</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-chỉ-hash-bị-thay-đổi">6.2 Chỉ hash bị thay đổi<a href="#62-chỉ-hash-bị-thay-đổi" class="hash-link" aria-label="Direct link to 6.2 Chỉ hash bị thay đổi" title="Direct link to 6.2 Chỉ hash bị thay đổi">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Kiểm tra trước và sau filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Trước khi filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git log --format=&quot;%H|%ad|%an|%s&quot; --date=iso &gt; commits_before.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sau khi filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git log --format=&quot;%H|%ad|%an|%s&quot; --date=iso &gt; commits_after.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># So sánh (chỉ hash khác, còn lại giống nhau)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paste commits_before.txt commits_after.txt | column -t -s&#x27;|&#x27;</span><br></span></code></pre></div></div>
<p><strong>Ví dụ kết quả:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Trước: abc123|2023-01-15 10:30:00|John Doe|Add feature X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sau:   def456|2023-01-15 10:30:00|John Doe|Add feature X</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-chính-sách-github-về-commit-bị-ghi-đè">7. Chính sách GitHub về commit bị ghi đè<a href="#7-chính-sách-github-về-commit-bị-ghi-đè" class="hash-link" aria-label="Direct link to 7. Chính sách GitHub về commit bị ghi đè" title="Direct link to 7. Chính sách GitHub về commit bị ghi đè">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-timeline-xóa-commit">7.1 Timeline xóa commit<a href="#71-timeline-xóa-commit" class="hash-link" aria-label="Direct link to 7.1 Timeline xóa commit" title="Direct link to 7.1 Timeline xóa commit">​</a></h3>
<ul>
<li><strong>Ngày 1</strong>: Force push, commit cũ bị ghi đè</li>
<li><strong>Ngày 1-30</strong>: Commit cũ vẫn tồn tại, có thể truy cập</li>
<li><strong>Ngày 30-90</strong>: GitHub chạy garbage collection</li>
<li><strong>Sau ngày 90</strong>: Commit cũ bị xóa vĩnh viễn</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-các-điểm-quan-trọng">7.2 Các điểm quan trọng<a href="#72-các-điểm-quan-trọng" class="hash-link" aria-label="Direct link to 7.2 Các điểm quan trọng" title="Direct link to 7.2 Các điểm quan trọng">​</a></h3>
<ul>
<li>Commits bị ghi đè lưu trữ tạm thời 30-90 ngày</li>
<li>Pull Requests đã merge lưu vĩnh viễn ngay cả khi branch bị xóa</li>
<li>Có thể khôi phục trong grace period nếu biết commit hash</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Truy cập commit cũ trong grace period</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git show &lt;old-commit-hash&gt;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-lưu-ý-quan-trọng">8. Lưu ý quan trọng<a href="#8-lưu-ý-quan-trọng" class="hash-link" aria-label="Direct link to 8. Lưu ý quan trọng" title="Direct link to 8. Lưu ý quan trọng">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="81-tác-động-đến-team">8.1 Tác động đến team<a href="#81-tác-động-đến-team" class="hash-link" aria-label="Direct link to 8.1 Tác động đến team" title="Direct link to 8.1 Tác động đến team">​</a></h3>
<p>⚠️ <strong>Cảnh báo</strong>: Việc rewrite history có tác động lớn:</p>
<ul>
<li>Backup repository trước khi thực hiện</li>
<li>Thông báo team vì họ cần re-clone repository</li>
<li>Tất cả collaborators phải xóa local repo và clone lại</li>
<li>Pull requests/forks sẽ bị conflict</li>
<li>Commit hashes thay đổi hoàn toàn</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="82-best-practices">8.2 Best practices<a href="#82-best-practices" class="hash-link" aria-label="Direct link to 8.2 Best practices" title="Direct link to 8.2 Best practices">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. Backup trước khi thực hiện</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git branch backup-before-filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. Test trên clone riêng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone --no-hardlinks original-repo test-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. Thông báo team ngay lập tức</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. Yêu cầu mọi người re-clone repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 5. Đợi 90 ngày để GitHub garbage collect</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-kết-luận">9. Kết luận<a href="#9-kết-luận" class="hash-link" aria-label="Direct link to 9. Kết luận" title="Direct link to 9. Kết luận">​</a></h2>
<p>Việc loại bỏ commit không mong muốn khỏi Git history là possible nhưng cần cẩn trọng. Phương pháp git filter-repo là khuyến nghị vì:</p>
<ol>
<li><strong>Nhanh và hiệu quả</strong> hơn filter-branch</li>
<li><strong>Bảo toàn thông tin</strong> author và timestamp</li>
<li><strong>Flexible</strong> với nhiều tùy chọn filter</li>
<li><strong>An toàn</strong> hơn các phương pháp khác</li>
</ol>
<p><strong>Lưu ý cuối</strong>: Luôn backup và thông báo team trước khi thực hiện rewrite history!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/viethungle0503/viethungle/tree/main/docs/docs/tutorials/git-structure-and-commit-removal.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/viethungle/docs/tutorials/gpg4win-backup-restore-private-key"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Backup và Restore Private Key GPG trên Windows với GPG4win</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/viethungle/docs/tutorials/python_version_management"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Quản lý phiên bản Python</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-cấu-trúc-thư-mục-git" class="table-of-contents__link toc-highlight">1. Cấu trúc thư mục .git</a><ul><li><a href="#11-các-thư-mục-cốt-lõi" class="table-of-contents__link toc-highlight">1.1 Các thư mục cốt lõi</a></li><li><a href="#12-giải-thích-chi-tiết-objectspack" class="table-of-contents__link toc-highlight">1.2 Giải thích chi tiết objects/pack</a></li></ul></li><li><a href="#2-liệt-kê-commit-theo-dung-lượng" class="table-of-contents__link toc-highlight">2. Liệt kê commit theo dung lượng</a><ul><li><a href="#21-lệnh-cơ-bản-liệt-kê-commit-theo-kích-thước" class="table-of-contents__link toc-highlight">2.1 Lệnh cơ bản liệt kê commit theo kích thước</a></li><li><a href="#22-tìm-các-file-lớn-nhất-trong-repository" class="table-of-contents__link toc-highlight">2.2 Tìm các file lớn nhất trong repository</a></li><li><a href="#23-phân-tích-commit-chi-tiết" class="table-of-contents__link toc-highlight">2.3 Phân tích commit chi tiết</a></li></ul></li><li><a href="#3-loại-bỏ-commit-không-mong-muốn-với-git-filter-repo" class="table-of-contents__link toc-highlight">3. Loại bỏ commit không mong muốn với git filter-repo</a><ul><li><a href="#31-cài-đặt-git-filter-repo" class="table-of-contents__link toc-highlight">3.1 Cài đặt git-filter-repo</a></li><li><a href="#32-loại-bỏ-thư-mục-khỏi-toàn-bộ-lịch-sử" class="table-of-contents__link toc-highlight">3.2 Loại bỏ thư mục khỏi toàn bộ lịch sử</a></li><li><a href="#33-xử-lý-lỗi-not-a-fresh-clone" class="table-of-contents__link toc-highlight">3.3 Xử lý lỗi &quot;not a fresh clone&quot;</a></li></ul></li><li><a href="#4-phương-pháp-thay-thế" class="table-of-contents__link toc-highlight">4. Phương pháp thay thế</a><ul><li><a href="#41-sử-dụng-bfg-repo-cleaner" class="table-of-contents__link toc-highlight">4.1 Sử dụng BFG Repo-Cleaner</a></li><li><a href="#42-git-filter-branch-phương-pháp-cũ" class="table-of-contents__link toc-highlight">4.2 Git filter-branch (phương pháp cũ)</a></li></ul></li><li><a href="#5-dọn-dẹp-sau-khi-filter" class="table-of-contents__link toc-highlight">5. Dọn dẹp sau khi filter</a><ul><li><a href="#51-cleanup-commands" class="table-of-contents__link toc-highlight">5.1 Cleanup commands</a></li><li><a href="#52-kiểm-tra-kết-quả" class="table-of-contents__link toc-highlight">5.2 Kiểm tra kết quả</a></li></ul></li><li><a href="#6-thông-tin-được-bảo-toàn" class="table-of-contents__link toc-highlight">6. Thông tin được bảo toàn</a><ul><li><a href="#61-dữ-liệu-không-thay-đổi" class="table-of-contents__link toc-highlight">6.1 Dữ liệu không thay đổi</a></li><li><a href="#62-chỉ-hash-bị-thay-đổi" class="table-of-contents__link toc-highlight">6.2 Chỉ hash bị thay đổi</a></li></ul></li><li><a href="#7-chính-sách-github-về-commit-bị-ghi-đè" class="table-of-contents__link toc-highlight">7. Chính sách GitHub về commit bị ghi đè</a><ul><li><a href="#71-timeline-xóa-commit" class="table-of-contents__link toc-highlight">7.1 Timeline xóa commit</a></li><li><a href="#72-các-điểm-quan-trọng" class="table-of-contents__link toc-highlight">7.2 Các điểm quan trọng</a></li></ul></li><li><a href="#8-lưu-ý-quan-trọng" class="table-of-contents__link toc-highlight">8. Lưu ý quan trọng</a><ul><li><a href="#81-tác-động-đến-team" class="table-of-contents__link toc-highlight">8.1 Tác động đến team</a></li><li><a href="#82-best-practices" class="table-of-contents__link toc-highlight">8.2 Best practices</a></li></ul></li><li><a href="#9-kết-luận" class="table-of-contents__link toc-highlight">9. Kết luận</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/viethungle/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.facebook.com/viethung.le.35110418" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/viethungle0503/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/viethungle/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/viethungle0503/viethungle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Lê Việt Hưng, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>