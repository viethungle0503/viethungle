<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis | Lê Việt Hưng</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://viethungle0503.github.io/viethungle/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://viethungle0503.github.io/viethungle/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis | Lê Việt Hưng"><meta data-rh="true" name="description" content="P/s: Đừng trả lời kiểu &quot;hệ thống của em đâu có đến 1 tỷ user đâu anh ơi…&quot; nha! Ở công ty có quy mô từ vừa đến lớn thì việc tiết kiệm tài nguyên và phản hồi nhanh rất được quan tâm, phỏng vấn thì phải có tí challenge mới vui chứ!"><meta data-rh="true" property="og:description" content="P/s: Đừng trả lời kiểu &quot;hệ thống của em đâu có đến 1 tỷ user đâu anh ơi…&quot; nha! Ở công ty có quy mô từ vừa đến lớn thì việc tiết kiệm tài nguyên và phản hồi nhanh rất được quan tâm, phỏng vấn thì phải có tí challenge mới vui chứ!"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-06-10T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/viethungle0503"><meta data-rh="true" property="article:tag" content="Redis,Bloom Filter,Database,System Design,Performance,Interview,Development"><link data-rh="true" rel="icon" href="/viethungle/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check"><link data-rh="true" rel="alternate" href="https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check" hreflang="en"><link data-rh="true" rel="alternate" href="https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check","mainEntityOfPage":"https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check","url":"https://viethungle0503.github.io/viethungle/blog/bloom-filter-redis-username-check","headline":"Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis","name":"Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis","description":"P/s: Đừng trả lời kiểu \"hệ thống của em đâu có đến 1 tỷ user đâu anh ơi…\" nha! Ở công ty có quy mô từ vừa đến lớn thì việc tiết kiệm tài nguyên và phản hồi nhanh rất được quan tâm, phỏng vấn thì phải có tí challenge mới vui chứ!","datePublished":"2025-06-10T00:00:00.000Z","author":{"@type":"Person","name":"Lê Việt Hưng","description":"Realtime Robotics Web Developer","url":"https://github.com/viethungle0503","image":"https://github.com/viethungle0503.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://viethungle0503.github.io/viethungle/blog","name":"All Blog Posts"}}</script><link rel="alternate" type="application/rss+xml" href="/viethungle/blog/rss.xml" title="Lê Việt Hưng RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/viethungle/blog/atom.xml" title="Lê Việt Hưng Atom Feed"><link rel="stylesheet" href="/viethungle/assets/css/styles.2eab34b2.css">
<script src="/viethungle/assets/js/runtime~main.5a0a5436.js" defer="defer"></script>
<script src="/viethungle/assets/js/main.43ec6d95.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/viethungle/img/logo.svg"><link rel="preload" as="image" href="https://github.com/viethungle0503.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/viethungle/"><div class="navbar__logo"><img src="/viethungle/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/viethungle/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a class="navbar__item navbar__link" href="/viethungle/docs/git-tips">Tutorial</a><a class="navbar__item navbar__link" href="/viethungle/docs/gaming/ark-cheats">Gaming</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/viethungle/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/viethungle/blog/bloom-filter-redis-username-check">Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/alova-vs-axios-comparison">So Sánh Chi Tiết: AlovaJS vs Axios - Lựa Chọn HTTP Client Nào Cho Dự Án Frontend?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/crypto-exchange-affiliate-programs">Guide to Top Cryptocurrency Exchange Affiliate Programs in 2025</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/evolution-of-vietnamese-leadership-structure">The Evolution of Vietnam&#x27;s Leadership Structure Through History</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/understanding-stablecoin-types">Understanding the 5 Types of Stablecoins in the Crypto Ecosystem</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/top-hardware-wallets-for-crypto-security">Top Hardware Wallets for Cryptocurrency Security in 2025</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/the-king-and-the-milk-fruit">The King and the Milk Fruit - A Tale of Financial Folly</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/vua-va-qua-vu-sua">Vua và Quả Vú Sữa - Câu Chuyện Về Sự Tham Lam</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/cutting-edge-github-projects-2025">10 Cutting-Edge GitHub Projects You Should Know About in 2025</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/open-source-game-changers-2025">11 Open Source Projects That Are Legit Game Changers in 2025</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/welcome">Welcome</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/mdx-blog-post">MDX Blog Post</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2019</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/long-blog-post">Long Blog Post</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/viethungle/blog/first-blog-post">First Blog Post</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Kiểm tra tên đăng nhập trong 1 tỷ người dùng với Bloom Filter và Redis</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-06-10T00:00:00.000Z">June 10, 2025</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/viethungle/blog/authors/viethungle-0503"><img class="avatar__photo authorImage_XqGP" src="https://github.com/viethungle0503.png" alt="Lê Việt Hưng"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/viethungle/blog/authors/viethungle-0503"><span class="authorName_yefp">Lê Việt Hưng</span></a></div><small class="authorTitle_nd0D" title="Realtime Robotics Web Developer">Realtime Robotics Web Developer</small><div class="authorSocials_rSDt"><a href="https://github.com/viethungle0503" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><em>P/s: Đừng trả lời kiểu &quot;hệ thống của em đâu có đến 1 tỷ user đâu anh ơi…&quot; nha! Ở công ty có quy mô từ vừa đến lớn thì việc tiết kiệm tài nguyên và phản hồi nhanh rất được quan tâm, phỏng vấn thì phải có tí challenge mới vui chứ!</em></p>
<p>Với hàng tỷ người dùng, làm sao hệ thống có thể kiểm tra nhanh tên đăng nhập đã được sử dụng hay chưa? Nếu mỗi lần đều truy vấn trực tiếp vào database thì sẽ rất chậm và tốn tài nguyên.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-giải-pháp-tối-ưu-redisbloom---bloom-filter-trên-redis">🚀 Giải pháp tối ưu: RedisBloom - Bloom Filter trên Redis!<a href="#-giải-pháp-tối-ưu-redisbloom---bloom-filter-trên-redis" class="hash-link" aria-label="Direct link to 🚀 Giải pháp tối ưu: RedisBloom - Bloom Filter trên Redis!" title="Direct link to 🚀 Giải pháp tối ưu: RedisBloom - Bloom Filter trên Redis!">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bloom-filter-là-gì">Bloom Filter là gì?<a href="#bloom-filter-là-gì" class="hash-link" aria-label="Direct link to Bloom Filter là gì?" title="Direct link to Bloom Filter là gì?">​</a></h3>
<p>Một cấu trúc dữ liệu &quot;thông minh&quot;, chuyên dùng kiểm tra xem phần tử có thuộc tập hợp không, với các điểm mạnh sau:</p>
<p>✅ <strong>Siêu tiết kiệm bộ nhớ</strong>: Chỉ cần một phần nhỏ dung lượng so với việc lưu toàn bộ dữ liệu.<br>
<!-- -->✅ <strong>Tốc độ truy vấn cực nhanh</strong>: Chỉ vài thao tác hash là có ngay kết quả.<br>
<!-- -->⚠️ <strong>Nhưng có thể trả về &quot;dương tính giả&quot; (false positive)</strong>: Đôi lúc báo tên đã tồn tại, mặc dù thật ra chưa (trong trường hợp này không gây ảnh hưởng gì cả).</p>
<p>Tuy vậy, trong thực tế (như kiểm tra tên đăng nhập), mức &quot;nhầm&quot; này hoàn toàn kiểm soát và chấp nhận được – đổi lại bạn có tốc độ xử lý cực nhanh và bộ nhớ siêu tối ưu!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-bài-toán-kiểm-tra-tên-đăng-nhập-trong-1-tỷ-người-dùng">🎯 Bài toán: Kiểm tra tên đăng nhập trong 1 tỷ người dùng<a href="#-bài-toán-kiểm-tra-tên-đăng-nhập-trong-1-tỷ-người-dùng" class="hash-link" aria-label="Direct link to 🎯 Bài toán: Kiểm tra tên đăng nhập trong 1 tỷ người dùng" title="Direct link to 🎯 Bài toán: Kiểm tra tên đăng nhập trong 1 tỷ người dùng">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="thách-thức-chính">Thách thức chính:<a href="#thách-thức-chính" class="hash-link" aria-label="Direct link to Thách thức chính:" title="Direct link to Thách thức chính:">​</a></h3>
<ul>
<li>Với 1 tỷ người dùng, việc truy vấn trực tiếp database mỗi lần kiểm tra sẽ rất chậm</li>
<li>Tốn nhiều tài nguyên hệ thống (CPU, I/O, network)</li>
<li>Trải nghiệm người dùng kém do phải chờ đợi</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-giải-pháp-bloom-filter-với-redisbloom">💡 Giải pháp: Bloom Filter với RedisBloom<a href="#-giải-pháp-bloom-filter-với-redisbloom" class="hash-link" aria-label="Direct link to 💡 Giải pháp: Bloom Filter với RedisBloom" title="Direct link to 💡 Giải pháp: Bloom Filter với RedisBloom">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bloom-filter-hoạt-động-như-thế-nào">Bloom Filter hoạt động như thế nào?<a href="#bloom-filter-hoạt-động-như-thế-nào" class="hash-link" aria-label="Direct link to Bloom Filter hoạt động như thế nào?" title="Direct link to Bloom Filter hoạt động như thế nào?">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-cấu-trúc-dữ-liệu">1. Cấu trúc dữ liệu:<a href="#1-cấu-trúc-dữ-liệu" class="hash-link" aria-label="Direct link to 1. Cấu trúc dữ liệu:" title="Direct link to 1. Cấu trúc dữ liệu:">​</a></h4>
<ul>
<li>Là một mảng bit có kích thước cố định (ví dụ: 10 triệu bit)</li>
<li>Ban đầu tất cả bit đều = 0</li>
<li>Sử dụng nhiều hàm hash khác nhau (thường 3-7 hàm)</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-thêm-phần-tử-username">2. Thêm phần tử (username):<a href="#2-thêm-phần-tử-username" class="hash-link" aria-label="Direct link to 2. Thêm phần tử (username):" title="Direct link to 2. Thêm phần tử (username):">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Username &quot;john123&quot; → </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash1(&quot;john123&quot;) = 1247 → set bit[1247] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash2(&quot;john123&quot;) = 8932 → set bit[8932] = 1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash3(&quot;john123&quot;) = 5681 → set bit[5681] = 1</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-kiểm-tra-phần-tử">3. Kiểm tra phần tử:<a href="#3-kiểm-tra-phần-tử" class="hash-link" aria-label="Direct link to 3. Kiểm tra phần tử:" title="Direct link to 3. Kiểm tra phần tử:">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Kiểm tra &quot;mary456&quot; →</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash1(&quot;mary456&quot;) = 1247 → bit[1247] = 1 ✓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash2(&quot;mary456&quot;) = 3421 → bit[3421] = 0 ✗</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ Kết quả: KHÔNG tồn tại (chắc chắn 100%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kiểm tra &quot;bob789&quot; →</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash1(&quot;bob789&quot;) = 1247 → bit[1247] = 1 ✓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash2(&quot;bob789&quot;) = 8932 → bit[8932] = 1 ✓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash3(&quot;bob789&quot;) = 2156 → bit[2156] = 1 ✓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ Kết quả: CÓ THỂ tồn tại (cần kiểm tra thêm)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-ưu-điểm-của-giải-pháp">🏆 Ưu điểm của giải pháp:<a href="#-ưu-điểm-của-giải-pháp" class="hash-link" aria-label="Direct link to 🏆 Ưu điểm của giải pháp:" title="Direct link to 🏆 Ưu điểm của giải pháp:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-tiết-kiệm-bộ-nhớ-cực-kỳ">1. Tiết kiệm bộ nhớ cực kỳ:<a href="#1-tiết-kiệm-bộ-nhớ-cực-kỳ" class="hash-link" aria-label="Direct link to 1. Tiết kiệm bộ nhớ cực kỳ:" title="Direct link to 1. Tiết kiệm bộ nhớ cực kỳ:">​</a></h3>
<ul>
<li><strong>1 tỷ username nếu lưu trực tiếp</strong>: ~50GB (trung bình 50 ký tự/username)</li>
<li><strong>Bloom Filter</strong>: chỉ cần ~1.2GB với tỷ lệ false positive 1%</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-tốc-độ-siêu-nhanh">2. Tốc độ siêu nhanh:<a href="#2-tốc-độ-siêu-nhanh" class="hash-link" aria-label="Direct link to 2. Tốc độ siêu nhanh:" title="Direct link to 2. Tốc độ siêu nhanh:">​</a></h3>
<ul>
<li>Chỉ cần vài phép hash đơn giản</li>
<li>Không cần truy vấn database</li>
<li>Thời gian trả lời: O(k) với k là số hàm hash</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-false-positive-được-kiểm-soát">3. False Positive được kiểm soát:<a href="#3-false-positive-được-kiểm-soát" class="hash-link" aria-label="Direct link to 3. False Positive được kiểm soát:" title="Direct link to 3. False Positive được kiểm soát:">​</a></h3>
<ul>
<li>Có thể điều chỉnh tỷ lệ false positive (1%, 0.1%, 0.01%...)</li>
<li>Không bao giờ có False Negative (nếu nó nói &quot;không tồn tại&quot; thì chắc chắn không tồn tại)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-triển-khai-thực-tế-với-redisbloom">⚙️ Triển khai thực tế với RedisBloom:<a href="#️-triển-khai-thực-tế-với-redisbloom" class="hash-link" aria-label="Direct link to ⚙️ Triển khai thực tế với RedisBloom:" title="Direct link to ⚙️ Triển khai thực tế với RedisBloom:">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Tạo Bloom Filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BF.RESERVE usernames 0.01 1000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Thêm username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BF.ADD usernames &quot;john123&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Kiểm tra username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BF.EXISTS usernames &quot;mary456&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="quy-trình-kiểm-tra-tối-ưu">Quy trình kiểm tra tối ưu:<a href="#quy-trình-kiểm-tra-tối-ưu" class="hash-link" aria-label="Direct link to Quy trình kiểm tra tối ưu:" title="Direct link to Quy trình kiểm tra tối ưu:">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">check_username_exists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Bước 1: Kiểm tra Bloom Filter (siêu nhanh)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> bloom_filter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Chắc chắn không tồn tại</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Bước 2: Chỉ khi Bloom Filter báo &quot;có thể tồn tại&quot; </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># mới truy vấn database để xác nhận</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-lợi-ích-trong-thực-tế">📊 Lợi ích trong thực tế:<a href="#-lợi-ích-trong-thực-tế" class="hash-link" aria-label="Direct link to 📊 Lợi ích trong thực tế:" title="Direct link to 📊 Lợi ích trong thực tế:">​</a></h2>
<ul>
<li><strong>Giảm 99%+ truy vấn database</strong>: Chỉ những trường hợp false positive mới cần truy vấn DB</li>
<li><strong>Tăng tốc độ phản hồi</strong>: Từ 100ms xuống còn 1ms</li>
<li><strong>Tiết kiệm chi phí</strong>: Ít tải cho database server, giảm chi phí cloud</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-điều-chỉnh-tỷ-lệ-false-positive">🔧 Điều chỉnh tỷ lệ False Positive<a href="#-điều-chỉnh-tỷ-lệ-false-positive" class="hash-link" aria-label="Direct link to 🔧 Điều chỉnh tỷ lệ False Positive" title="Direct link to 🔧 Điều chỉnh tỷ lệ False Positive">​</a></h2>
<p>Có 3 tham số chính ảnh hưởng đến false positive:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-kích-thước-mảng-bit-m">a) Kích thước mảng bit (m):<a href="#a-kích-thước-mảng-bit-m" class="hash-link" aria-label="Direct link to a) Kích thước mảng bit (m):" title="Direct link to a) Kích thước mảng bit (m):">​</a></h3>
<ul>
<li>Mảng bit càng lớn → false positive càng thấp</li>
<li>Nhưng tốn nhiều bộ nhớ hơn</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-số-hàm-hash-k">b) Số hàm hash (k):<a href="#b-số-hàm-hash-k" class="hash-link" aria-label="Direct link to b) Số hàm hash (k):" title="Direct link to b) Số hàm hash (k):">​</a></h3>
<ul>
<li>Có công thức tối ưu: <code>k = (m/n) × ln(2)</code></li>
<li>Với m = kích thước mảng bit, n = số phần tử</li>
<li>Quá ít hash → nhiều collision</li>
<li>Quá nhiều hash → tăng xác suất false positive</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-số-phần-tử-thực-tế-n">c) Số phần tử thực tế (n):<a href="#c-số-phần-tử-thực-tế-n" class="hash-link" aria-label="Direct link to c) Số phần tử thực tế (n):" title="Direct link to c) Số phần tử thực tế (n):">​</a></h3>
<ul>
<li>Càng nhiều phần tử → false positive càng cao</li>
</ul>
<p><strong>Công thức false positive:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">p ≈ (1 - e^(-kn/m))^k</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cấu-hình-redisbloom">Cấu hình RedisBloom:<a href="#cấu-hình-redisbloom" class="hash-link" aria-label="Direct link to Cấu hình RedisBloom:" title="Direct link to Cấu hình RedisBloom:">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Cách 1: Thiết lập false positive rate trực tiếp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BF.RESERVE usernames 0.01 1000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#                     ↑     ↑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#               false_rate capacity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cách 2: Thiết lập thủ công các tham số</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BF.RESERVE usernames 0.01 1000000000 EXPANSION 2 NONSCALING</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-redis-không-lưu-cache-toàn-bộ-username">🗄️ Redis KHÔNG lưu cache toàn bộ username<a href="#️-redis-không-lưu-cache-toàn-bộ-username" class="hash-link" aria-label="Direct link to 🗄️ Redis KHÔNG lưu cache toàn bộ username" title="Direct link to 🗄️ Redis KHÔNG lưu cache toàn bộ username">​</a></h2>
<p><strong>Điểm quan trọng</strong>: Redis không lưu trữ các username thực tế, mà chỉ lưu mảng bit của Bloom Filter.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cách-hoạt-động-thực-tế">Cách hoạt động thực tế:<a href="#cách-hoạt-động-thực-tế" class="hash-link" aria-label="Direct link to Cách hoạt động thực tế:" title="Direct link to Cách hoạt động thực tế:">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bước-1-khởi-tạo-bloom-filter-rỗng">Bước 1: Khởi tạo Bloom Filter rỗng<a href="#bước-1-khởi-tạo-bloom-filter-rỗng" class="hash-link" aria-label="Direct link to Bước 1: Khởi tạo Bloom Filter rỗng" title="Direct link to Bước 1: Khởi tạo Bloom Filter rỗng">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BF.RESERVE usernames 0.01 1000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Tạo mảng bit rỗng, kích thước ~1.2GB</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bước-2-dần-dần-thêm-username-vào-filter">Bước 2: Dần dần thêm username vào filter<a href="#bước-2-dần-dần-thêm-username-vào-filter" class="hash-link" aria-label="Direct link to Bước 2: Dần dần thêm username vào filter" title="Direct link to Bước 2: Dần dần thêm username vào filter">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Khi user đăng ký thành công</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">register_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Lưu vào database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">insert_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Đồng thời đánh dấu trong Bloom Filter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute_command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BF.ADD&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;usernames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bước-3-kiểm-tra-username">Bước 3: Kiểm tra username<a href="#bước-3-kiểm-tra-username" class="hash-link" aria-label="Direct link to Bước 3: Kiểm tra username" title="Direct link to Bước 3: Kiểm tra username">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">check_username_available</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Chỉ kiểm tra mảng bit, KHÔNG cần truy cập username gốc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exists_in_filter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute_command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BF.EXISTS&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;usernames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> exists_in_filter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Chắc chắn username available</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># False positive có thể xảy ra, cần kiểm tra DB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ví-dụ-cụ-thể">Ví dụ cụ thể:<a href="#ví-dụ-cụ-thể" class="hash-link" aria-label="Direct link to Ví dụ cụ thể:" title="Direct link to Ví dụ cụ thể:">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Giả sử có username &quot;john123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;john123&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Khi thêm vào Bloom Filter:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hash1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hash_func1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;john123&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> array_size  </span><span class="token comment" style="color:#999988;font-style:italic"># = 1247</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hash2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hash_func2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;john123&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> array_size  </span><span class="token comment" style="color:#999988;font-style:italic"># = 8932  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hash3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hash_func3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;john123&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> array_size  </span><span class="token comment" style="color:#999988;font-style:italic"># = 5681</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Redis chỉ lưu:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit_array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1247</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit_array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">8932</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit_array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5681</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># KHÔNG lưu chuỗi &quot;john123&quot; ở đâu cả!</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-so-sánh-bộ-nhớ">📈 So sánh bộ nhớ:<a href="#-so-sánh-bộ-nhớ" class="hash-link" aria-label="Direct link to 📈 So sánh bộ nhớ:" title="Direct link to 📈 So sánh bộ nhớ:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lưu-trực-tiếp-trong-redis">Lưu trực tiếp trong Redis:<a href="#lưu-trực-tiếp-trong-redis" class="hash-link" aria-label="Direct link to Lưu trực tiếp trong Redis:" title="Direct link to Lưu trực tiếp trong Redis:">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Tốn ~50GB cho 1 tỷ username</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;user:john123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;exists&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;user:mary456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;exists&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ... 1 tỷ records</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dùng-bloom-filter">Dùng Bloom Filter:<a href="#dùng-bloom-filter" class="hash-link" aria-label="Direct link to Dùng Bloom Filter:" title="Direct link to Dùng Bloom Filter:">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Chỉ tốn ~1.2GB cho mảng bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Chứa thông tin về 1 tỷ username nhưng không lưu username gốc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bit_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 10 tỷ bit</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-quy-trình-đồng-bộ-dữ-liệu">🔄 Quy trình đồng bộ dữ liệu:<a href="#-quy-trình-đồng-bộ-dữ-liệu" class="hash-link" aria-label="Direct link to 🔄 Quy trình đồng bộ dữ liệu:" title="Direct link to 🔄 Quy trình đồng bộ dữ liệu:">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Khi khởi động hệ thống lần đầu</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initialize_bloom_filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute_command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BF.RESERVE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;usernames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Load tất cả username từ DB và thêm vào filter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> username </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> database</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_all_usernames</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        redis</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute_command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;BF.ADD&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;usernames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-kết-luận">🎯 Kết luận<a href="#-kết-luận" class="hash-link" aria-label="Direct link to 🎯 Kết luận" title="Direct link to 🎯 Kết luận">​</a></h2>
<p>Đây là một ví dụ điển hình về cách tối ưu hóa hệ thống lớn bằng cách chấp nhận trade-off thông minh: <strong>đổi một chút độ chính xác lấy hiệu suất vượt trội</strong>.</p>
<p>Redis chỉ lưu trữ một cấu trúc dữ liệu nhỏ gọn (mảng bit) đại diện cho 1 tỷ username, chứ không phải lưu cache 1 tỷ string username!</p>
<hr>
<p><em>Bài viết này giải đáp chi tiết về một câu hỏi phỏng vấn system design phổ biến và cách áp dụng Bloom Filter trong thực tế để xây dựng hệ thống có hiệu suất cao.</em></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Redis in-memory data structure store" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/redis">Redis</a></li><li class="tag_QGVx"><a rel="tag" title="Probabilistic data structure for membership testing" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/bloom-filter">Bloom Filter</a></li><li class="tag_QGVx"><a rel="tag" title="Database systems and optimization techniques" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/database">Database</a></li><li class="tag_QGVx"><a rel="tag" title="Large-scale system architecture and design patterns" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/system-design">System Design</a></li><li class="tag_QGVx"><a rel="tag" title="Performance optimization and scalability topics" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/performance">Performance</a></li><li class="tag_QGVx"><a rel="tag" title="Interview questions about techniques" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/interview">Interview</a></li><li class="tag_QGVx"><a rel="tag" title="Software development tools and practices" class="tag_zVej tagRegular_sFm0" href="/viethungle/blog/tags/development">Development</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/viethungle0503/viethungle/tree/main/docs/blog/2025-06-10-bloom-filter-redis-username-check/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/viethungle/blog/alova-vs-axios-comparison"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">So Sánh Chi Tiết: AlovaJS vs Axios - Lựa Chọn HTTP Client Nào Cho Dự Án Frontend?</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-giải-pháp-tối-ưu-redisbloom---bloom-filter-trên-redis" class="table-of-contents__link toc-highlight">🚀 Giải pháp tối ưu: RedisBloom - Bloom Filter trên Redis!</a><ul><li><a href="#bloom-filter-là-gì" class="table-of-contents__link toc-highlight">Bloom Filter là gì?</a></li></ul></li><li><a href="#-bài-toán-kiểm-tra-tên-đăng-nhập-trong-1-tỷ-người-dùng" class="table-of-contents__link toc-highlight">🎯 Bài toán: Kiểm tra tên đăng nhập trong 1 tỷ người dùng</a><ul><li><a href="#thách-thức-chính" class="table-of-contents__link toc-highlight">Thách thức chính:</a></li></ul></li><li><a href="#-giải-pháp-bloom-filter-với-redisbloom" class="table-of-contents__link toc-highlight">💡 Giải pháp: Bloom Filter với RedisBloom</a><ul><li><a href="#bloom-filter-hoạt-động-như-thế-nào" class="table-of-contents__link toc-highlight">Bloom Filter hoạt động như thế nào?</a></li></ul></li><li><a href="#-ưu-điểm-của-giải-pháp" class="table-of-contents__link toc-highlight">🏆 Ưu điểm của giải pháp:</a><ul><li><a href="#1-tiết-kiệm-bộ-nhớ-cực-kỳ" class="table-of-contents__link toc-highlight">1. Tiết kiệm bộ nhớ cực kỳ:</a></li><li><a href="#2-tốc-độ-siêu-nhanh" class="table-of-contents__link toc-highlight">2. Tốc độ siêu nhanh:</a></li><li><a href="#3-false-positive-được-kiểm-soát" class="table-of-contents__link toc-highlight">3. False Positive được kiểm soát:</a></li></ul></li><li><a href="#️-triển-khai-thực-tế-với-redisbloom" class="table-of-contents__link toc-highlight">⚙️ Triển khai thực tế với RedisBloom:</a><ul><li><a href="#quy-trình-kiểm-tra-tối-ưu" class="table-of-contents__link toc-highlight">Quy trình kiểm tra tối ưu:</a></li></ul></li><li><a href="#-lợi-ích-trong-thực-tế" class="table-of-contents__link toc-highlight">📊 Lợi ích trong thực tế:</a></li><li><a href="#-điều-chỉnh-tỷ-lệ-false-positive" class="table-of-contents__link toc-highlight">🔧 Điều chỉnh tỷ lệ False Positive</a><ul><li><a href="#a-kích-thước-mảng-bit-m" class="table-of-contents__link toc-highlight">a) Kích thước mảng bit (m):</a></li><li><a href="#b-số-hàm-hash-k" class="table-of-contents__link toc-highlight">b) Số hàm hash (k):</a></li><li><a href="#c-số-phần-tử-thực-tế-n" class="table-of-contents__link toc-highlight">c) Số phần tử thực tế (n):</a></li><li><a href="#cấu-hình-redisbloom" class="table-of-contents__link toc-highlight">Cấu hình RedisBloom:</a></li></ul></li><li><a href="#️-redis-không-lưu-cache-toàn-bộ-username" class="table-of-contents__link toc-highlight">🗄️ Redis KHÔNG lưu cache toàn bộ username</a><ul><li><a href="#cách-hoạt-động-thực-tế" class="table-of-contents__link toc-highlight">Cách hoạt động thực tế:</a></li><li><a href="#ví-dụ-cụ-thể" class="table-of-contents__link toc-highlight">Ví dụ cụ thể:</a></li></ul></li><li><a href="#-so-sánh-bộ-nhớ" class="table-of-contents__link toc-highlight">📈 So sánh bộ nhớ:</a><ul><li><a href="#lưu-trực-tiếp-trong-redis" class="table-of-contents__link toc-highlight">Lưu trực tiếp trong Redis:</a></li><li><a href="#dùng-bloom-filter" class="table-of-contents__link toc-highlight">Dùng Bloom Filter:</a></li></ul></li><li><a href="#-quy-trình-đồng-bộ-dữ-liệu" class="table-of-contents__link toc-highlight">🔄 Quy trình đồng bộ dữ liệu:</a></li><li><a href="#-kết-luận" class="table-of-contents__link toc-highlight">🎯 Kết luận</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/viethungle/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.facebook.com/viethung.le.35110418" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/viethungle0503/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/viethungle/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/viethungle0503/viethungle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Lê Việt Hưng, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>